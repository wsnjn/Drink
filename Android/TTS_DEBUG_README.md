# TTS 调试指南

## 问题描述
经文朗读没有声音，需要诊断问题所在。

## 已添加的日志功能

### 1. 主要日志记录点

#### `readNextVerse()` 方法
- **开始朗读经文**: 显示当前朗读的经文内容
- **经文长度**: 显示清理后的经文字符数
- **当前TTS引擎**: 显示正在使用的TTS引擎名称
- **TTS对象状态**: 显示TTS对象是否可用
- **朗读方式选择**: 显示是使用内置语音还是TTS
- **朗读结果**: 显示TTS朗读的返回结果

#### `extractCleanVerseText()` 方法
- **输入经文**: 显示原始经文内容
- **清理过程**: 显示每个清理步骤的结果
- **最终结果**: 显示清理后的纯经文内容

#### `isTTSAvailable()` 方法
- **TTS对象状态**: 显示TTS对象是否存在
- **引擎信息**: 显示TTS引擎名称
- **语言设置**: 显示当前TTS语言
- **语言可用性**: 显示语言是否可用

#### `speakWithBuiltinVoice()` 方法
- **朗读文本**: 显示要朗读的文本内容
- **语音文件查找**: 显示是否找到对应的语音文件
- **播放方式**: 显示是播放预录制文件还是生成新文件

#### `playBuiltinVoiceFile()` 方法
- **文件加载**: 显示语音文件加载状态
- **MediaPlayer配置**: 显示播放器配置过程
- **播放状态**: 显示播放启动和完成状态

#### `generateAndSaveVoice()` 方法
- **TTS状态检查**: 显示TTS可用性
- **文件路径**: 显示目标文件路径
- **目录创建**: 显示语音目录创建状态
- **合成结果**: 显示TTS合成到文件的结果

### 2. 测试日志功能

在语音包管理菜单中添加了"测试日志记录"选项，可以：
- 测试所有日志记录功能
- 显示当前TTS状态
- 测试经文文本处理
- 在Logcat中查看详细日志

## 使用方法

### 1. 查看日志
1. 在Android Studio中打开Logcat
2. 过滤标签为"ReadFragment"
3. 开始朗读经文
4. 观察日志输出

### 2. 关键日志信息
- **TTS引擎**: 确认是否使用Google TTS
- **朗读文本**: 确认经文内容是否正确传递
- **朗读结果**: 确认TTS调用是否成功
- **错误信息**: 查看具体的失败原因

### 3. 常见问题诊断

#### 问题1: TTS对象为空
```
TTS对象状态: null
```
**解决方案**: 检查TTS初始化过程

#### 问题2: 引擎不是Google TTS
```
当前TTS引擎: com.xiaomi.tts
```
**解决方案**: 检查TTS引擎选择逻辑

#### 问题3: 朗读返回ERROR
```
Google TTS朗读结果: -1
```
**解决方案**: 检查TTS配置和权限

#### 问题4: 经文内容为空
```
当前朗读的经文: ''
```
**解决方案**: 检查经文文本提取逻辑

## 日志级别说明

- **Log.d()**: 调试信息，显示详细的执行流程
- **Log.w()**: 警告信息，显示潜在问题
- **Log.e()**: 错误信息，显示明确的错误

## 注意事项

1. 日志输出较多，建议在调试时使用过滤器
2. 生产环境可以适当减少日志输出
3. 关键错误信息会同时显示在Toast中
4. 所有日志都包含时间戳，便于追踪问题

## 下一步调试建议

1. 运行应用并开始朗读
2. 查看Logcat中的详细日志
3. 根据日志信息定位具体问题
4. 针对性地修复问题
5. 重新测试验证修复效果
